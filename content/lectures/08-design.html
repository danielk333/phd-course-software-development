---
title: "Software design"
description: "Everyone who has written software has designed it, but many designs are unconscious. We should strive to making the important decisions conscious, informed, and efficient. This lecture covers what software design is and what it is generally not, what consequences design decisions have and how to walk the line between just doing and over-engineering. "
handout: design
weight: 8
---

<div class="reveal">
    <div class="slides">

        <section
        data-auto-animate
        data-background-image="media/code.png"
        data-background-opacity="0.7"
        >
            <div class="centered-container">
            </div>
        </section>

        <section
        data-auto-animate
        data-background-image="media/code.png"
        data-background-opacity="0.15"
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <p class="fragment">We have already touched on design a lot</p>
                <p class="fragment mark">Today we will cover</p>
            </div>
        </section>


        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <p class="mark">Today we will cover</p>
                <ul>
                    <li>Communicating design / architecture</li>
                    <li class="fragment">Design on all levels of development</li>
                    <li class="fragment">What is a "design decision"</li>
                    <li class="fragment">What goes into that decision
                        <ul>
                            <li>Predictions</li>
                            <li>Scope</li>
                            <li>Experience</li>
                            <li>Requirements</li>
                            <li>...</li>
                        </ul>
                    </li>
                    <li class="fragment">Consequences of decisions</li>
                    <li class="fragment">Practical examples</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <p class="fragment highlight">The usual: visual representation + live explanation</p>
                <p class="fragment select">Success rate: questionable</p>
                <ul class="fragment">
                    <p>The suggestion: design the <u>design presentation</u> properly</p>
                    <li>Should it be stand-alone?</li>
                    <li>What story should it tell?</li>
                    <li>Who are you telling it to?</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <p>A good place to start: <span class="highlight">the C4 model</span>
                <br><a href="https://c4model.com/">c4model.com/</a></p>
                <ul class="fragment">
                    <li>Level 1: Context</li>
                    <li>Level 2: Containers (i.e. Environments)</li>
                    <li>Level 3: Components</li>
                    <li>Level 4: Code</li>
                </ul>
                <p class="fragment">Great introductory video in the handout - here quick summary</p>
            </div>
        </section>
    
        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 1: Context</li>
                </ul>
                <img src="diagrams/c4_context_example.png" class="light" style="height: 60vh; width:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <img src="diagrams/c4_context_example.png" class="light" style="height: 80vh; width:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 1: Context</li>
                </ul>
                <img src="diagrams/c4_context_example.png" class="light" style="height: 20vh; width:
                    auto; max-height: none; max-width: none;">
                <ul>
                    <li class="fragment select">This tells me how the Users interact with the system
                    and what external connections are made</li>
                    <li class="fragment">This should reflect the real-world usage of the system</li>
                    <li class="fragment">Its a map that should help me understand the context</li>
                    <li class="fragment mark">Even if this diagram is often trivial in research
                        software it might
                    not be!</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 1: Context</li>
                    <li>Level 2: Containers (i.e. Environments)</li>
                    <li>Level 3: Components</li>
                    <li>Level 4: Code</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 2: Containers (i.e. Environments)</li>
                </ul>
                <img src="diagrams/c4_container_example.png" class="light" style="height: 60vh; width:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <img src="diagrams/c4_container_example.png" class="light" style="height: 80vh; width:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 2: Containers (i.e. Environments)</li>
                </ul>
                <img src="diagrams/c4_container_example.png" class="light" style="height: 30vh; width:
                    auto; max-height: none; max-width: none;">
                <ul>
                    <li class="fragment select">This tells you what environments you need to manage and how
                        they interface with each other</li>
                    <li class="fragment">These should be reflected in your deployment, build,
                        dependency, and API management</li>
                    <li class="fragment">Its a map that should help me navigate and understand</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 1: Context</li>
                    <li>Level 2: Containers (i.e. Environments)</li>
                    <li>Level 3: Components</li>
                    <li>Level 4: Code</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 3: Components</li>
                </ul>
                <img src="diagrams/c4_component_example.png" class="light" style="height: 60vh; width:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <img src="diagrams/c4_component_example.png" class="light" style="height: 80vh; width:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 3: Components</li>
                </ul>
                <img src="diagrams/c4_component_example.png" class="light" style="height: 30vh; width:
                    auto; max-height: none; max-width: none;">
                <ul>
                    <li class="fragment select">This architecture should be reflected in the code!</li>
                    <li class="fragment">Think modules, subpackages, protocols, classes ...</li>
                    <li class="fragment">Its a map that should help me navigate and understand</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 4: Code</li>
                </ul>
                <ul>
                    <li class="fragment select">You should (in almost all cases) not draw these</li>
                    <li class="fragment">Read the code/docs instead</li>
                    <li class="fragment">Or auto-generate them from the code</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Communicating design / architecture</li>
                </ul>
                <ul>
                    <li>Level 4: Code</li>
                </ul>
                <p class="highlight">Here is the call-graph of a simple TCP client Request
                    call</p>
                <img src="media/pycallgraph.png" class="light" style="width: 80vw; height:
                    auto; max-height: none; max-width: none;">
            </div>
        </section>


        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <p class="mark">Today we will cover</p>
                <ul>
                    <li>Communicating design / architecture</li>
                    <li>Design on all levels of development</li>
                    <li>What is a "design decision"</li>
                    <li>What goes into that decision</li>
                    <li>Consequences of decisions</li>
                    <li>Practical examples</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p class="fragment highlight">Design decisions on different levels have different consequences</p>
                <p class="fragment">Example: A solar-system dynamics simulation tool</p>
                <p class="fragment">Level 1 Context example - where do I get my data?</p>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 1 Context example - where do I get my data?</p>
                <img class="fragment light" src="diagrams/c4_context_example.png" 
                    style="height: auto; width: 25vw; max-height: none; max-width: none;">
            </div>
        </section>


        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 1 Context example - where do I get my data?</p>
                <img class="light" src="diagrams/c4_context_example_v2.png" 
                    style="height: auto; width: 25vw; max-height: none; max-width: none;">
                <p class="fragment">Instead include the Kernel parsing as a component</p>
                <p class="fragment select">Pros vs Cons?</p>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 1 Context example - where do I get my data?</p>
                <ul class="list-sep-small">
                    <li>Option 1: Only simple API call needed, dependant on network, not reproducible, no
                    kernel choice</li>
                    <li>Option 2: Requires manual kernel parsing, offline, reproducible, completely
                        configurable</li>
                    <li class="mark">Which one is better?</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 2 Container example - How do I view the results?</p>
                <img src="diagrams/c4_container_example.png" class="fragment light" 
                    style="height: 55vh; width: auto; max-height: none; max-width: none;">
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 2 Container example - How do I view the results?</p>
                <img src="diagrams/c4_container_example_v2.png" class="light" 
                    style="height: 55vh; width: auto; max-height: none; max-width: none;">
            </div>
        </section>
        
        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 2 Container example - How do I view the results?</p>
                <ul>
                    <li>Option 1: A server that streams the resulting video</li>
                    <ul>
                        <li>No client requirements (except video receive)</li>
                        <li>Server side calculations</li>
                        <li>Limited user control possible</li>
                    </ul>
                    <li>Option 2: A viewer that renders the results in a GUI</li>
                    <ul>
                        <li>User must compile/run viewer</li>
                        <li>User must download/access all data and have sufficient hardware</li>
                        <li>Total user control possible</li>
                    </ul>
                    <li class="mark">Which one is better?</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 3 Component example - How do I visualize the data?</p>
                <ul class="fragment">
                    <li>Option 1: Static</li>
                    <ul>
                        <li>No real-time rendering requirement</li>
                        <li>Simple interface, slow user exploration</li>
                        <li>Simple / flexible implementation</li>
                    </ul>
                    <li>Option 2: Interactive</li>
                    <ul>
                        <li>Real-time rendering</li>
                        <li>Interactive UI, fast user exploration</li>
                        <li>Complex GPU implementation</li>
                    </ul>
                    <li class="mark">Which one is better?</li>
                </ul>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 4 Code example - How do I represent the data?</p>
                <pre class="fragment show-code">
                    <code data-line-numbers data-trim class="language-python" style="height: 45vh;">
                        class Position3D:
                            def __init__(self, x, y, z):
                                self.x = x
                                self.y = y
                                self.z = z


                        class Velocity3D:
                            def __init__(self, vx, vy, vz):
                                self.vx = vx
                                self.vy = vy
                                self.vz = vz


                        class State:
                            def __init__(self, pos: Position3D, vel: Velocity3D):
                                self.position = pos
                                self.velocity = vel


                        class Simulation:
                            def __init__(self, file):
                                self.objects = {}
                                for identifier, state in read_simulation(file):
                                    self.objects[identifier] = State(
                                        Position3D(state[0], state[1], state[2]),
                                        Velocity3D(state[3], state[4], state[5]),
                                    )

                    </code>
                </pre>
                <p class="fragment select">Versus</p>
            </div>
        </section>

        <section
        data-auto-animate
        >
            <div class="centered-container">
                <h3 class="title">Software design</h3>
                <ul>
                    <li>Design on all levels of development</li>
                </ul>
                <p>Level 4 Code example - How do I represent the data?</p>
                <pre class="show-code">
                    <code data-line-numbers data-trim class="language-python" style="height: 45vh;">
                        from dataclasses import dataclass, field
                        import numpy as np
                        import numpy.typing as npt


                        @dataclass
                        class States:
                            positions: npt.NDArray[np.float64]
                            velocities: npt.NDArray[np.float64]
                            ids: npt.NDArray[np.dtype("U8")]
                            objects: dict[np.dtype("U8"), int] = field(init=False)

                            def __post_init__(self):
                                self.objects = {obj: ind for ind, obj in enumerate(self.ids)}

                        def load_simulation(file) -> States:
                            states, ids = read_simulation(file)
                            return States(
                                positions=states[:3, :],
                                velocities=states[3:, :],
                                ids=ids,
                            )
                    </code>
                </pre>
                <p class="fragment select">Why?</p>
            </div>
        </section>
    </div>
</div>

